## 1. 値オブジェクトとは
プログラミング言語のプリミティブな値をシステム固有の値として表現するためのパターン

## 2. 値の性質
値の代表的な3つの性質
1. 不変である
2. 交換が可能である
3. 等価性によって比較される

値オブジェクトはシステム固有の値の表現であり、値の一種である

値が持つ性質は値オブジェクトにそのまま適用される

### 2-1. 不変である
```Scala
var greet = "こんにちは"
println(greet) // こんにちは

greet = "Hello"
println(greet) // Hello
```
greet の値は最初は `こんにちは` になっており、出力した後に `Hello` が再代入されている。したがって値は変更できるものであると考える。

しかし、厳密には値自体の変更はしていない。ここでは「代入」を利用しているため、値そのものが変わっているのではなく、変数の中の値が変わっている。

値は一貫して変化することがない。値が変化できてしまった場合は以下のようなコードになる。
```Scala
var greet = "こんにちは"
greet.changeTo("Hello") // 存在しないメソッド
println(greet) // Hello

// ↑ のコードが許されるのであればこのコードも許されることになる
"こんにちは".changeTo("Hello")
println("こんにちは") // Hello
```
changeTo メソッドを値を変更する振る舞いである。値自体の変更は安心して値を利用できなくなる。

```Scala
var fullName = FullName("大谷", "翔平")
fullName.changeLastName("三浦")
```
こういったコードはサンプルコードなどでよく見かけるが、FullName クラスを値ととらえた場合このコードは値を変更しているため不自然である。
changeLastName メソッドは「不変である」という値の性質上、クラスに定義するべきメソッドではない。

#### 不変のメリット/デメリット
**メリット**
- 生成したインスタンスの状態が自分の知らないところで変更されている事態を防ぐことができる

**デメリット**
- オブジェクトの値を一部でも変更する場合、新たなインスタンスが生成されること

### 2-2. 交換が可能である
値は不変だが、開発するにあたって値を変更しないことはない。
値オブジェクトもプリミティブな値を変更する時と、同じような変更方法でなければならない。（代入操作によって変更）
```Scala
import Knowledge.ValueObject.FullName
var num = 0
num = 1
println(num) // 1

// プリミティブな値と変更方法は同じ
var fullName = FullName("大谷", "翔平")
fullName = FullName("山本", "由伸")

// Scala はデフォルトで immutable(不変)な変数のため再代入をすることも少ない
val fullName2 = FullName("根尾", "昂")
fullName2 = FullName("藤原", "恭大") // 代入できない
```

### 2-3. 等価性によって比較される
#### 等価性とは
同値性とも呼ばれることもあるそう。（名前的にこっちの方が直感的）

ある2つのオブジェクトが全く同じ値を持つ時、等価という。

Scala では、==, equals で等価性を判断できる。

### 同一性とは
似た言葉に同一性がある。

ある2つのオブジェクトが同一のもの（同じインスタンス）であれば同一と見なされる。

Scala では eq で同一性を判断できる。
```Scala
val str  = "A"
val str2 = "A"

str == str2 // true

val fullName  = FullName("大谷", "翔平")
val fullName2 = FullName("大谷", "翔平")

// 等価性を判断
fullName == fullName2 // true
fullName equals fullName2 // true

// 同一性を判断
fullName eq fullName2 // false
```
値オブジェクトはプリミティブな値と同じように等価性を判断できるメソッド持たなければならない。
Scala の場合は、標準で備わっている。FullName メソッドに等価を判断するメソッドがない場合、等価を判断するための式が散らばるため、標準でない場合はクラスに定義すること。

### 2-4. 値オブジェクトを採用するモチベーション

値オブジェクトを採用するモチベーションは主に次の4つ
- 表現力を増す
- 不正な値を存在させない
- 誤った代入を防ぐ
- ロジックの散財を防ぐ


